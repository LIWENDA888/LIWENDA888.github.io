<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>字库产品 - 自在造字(ZIZAO)</title>
    <meta name="description" content="自在造字，专注字体字库产品制作与分享">
    <link rel="icon" href="https://pic3.fukit.cn/autoupload/NWINCyTOTWqNUcPQazQq69iO_OyvX7mIgxFBfDMDErs/20251123/AR9P/ico.ico">
    
    <!-- 引入公共样式 -->
    <link rel="stylesheet" href="common.css">

    <style>
        /* --- 页面特有样式 --- */
        body { background-color: #ffffff; }

        .doc-container {
            width: 100%; max-width: 1600px; 
            margin: 60px auto 40px; /* 增加顶部间距，避免贴顶 */
            padding: 0 30px; 
            display: flex; gap: 30px; 
        }

        /* 侧边栏 */
        .sidebar {
            width: 300px; flex-shrink: 0; position: sticky; top: 120px; 
            max-height: calc(100vh - 160px); overflow-y: auto; 
            border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 12px; padding: 10px 0; 
        }
        .sidebar::-webkit-scrollbar { width: 0; }
        .sidebar-menu { list-style: none; padding: 0 10px; }
        .category-header { 
            padding: 12px 15px; font-weight: 700; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-radius: 8px; margin-top: 10px;
        }
        .category-header:hover { background-color: rgba(0,0,0,0.03); }
        .category-header span { font-size: 10px; transform: rotate(-90deg); transition: transform 0.3s; }
        .category-header.open span { transform: rotate(0deg); }
        .subcategory-list { list-style: none; overflow: hidden; max-height: 0; transition: max-height 0.4s ease-out; padding: 0 5px; }
        .subcategory-link { display: flex; justify-content: space-between; padding: 10px 15px; color: #666; font-size: 15px; border-radius: 6px; }
        .subcategory-link:hover { color: #1a1a1a; background-color: rgba(0,0,0,0.02); }
        .subcategory-link.active { color: #1a1a1a; font-weight: 600; background-color: rgba(0,0,0,0.05); }
        .count-badge { font-size: 12px; background: rgba(0,0,0,0.04); padding: 2px 8px; border-radius: 10px; }

        /* 风格筛选网格 */
        .subcategory-list.style-grid { display: flex; flex-wrap: wrap; gap: 5px; padding: 5px !important; }
        .subcategory-list.style-grid .subcategory-link { padding: 8px 12px; width: auto; flex-grow: 0; justify-content: center; }

        /* 内容区 */
        .content-area { flex-grow: 1; display: flex; flex-direction: column; }
        .grid-header { margin-bottom: 20px; }
        .grid-header h2 { font-size: 24px; font-weight: 700; }
        .grid-header p { font-size: 14px; color: #666; margin-top: 5px; }

        /* Font Grid Layout Optimization */
        .font-grid { 
            display: grid; 
            /* 使用 auto-fill 和 minmax 确保响应式。
               当容器变宽时，列数增加；变窄时，列数减少。
               minmax(260px, 1fr) 意味着列宽至少 260px，若空间不足则换行。
            */
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); 
            gap: 25px; 
        }
        
        /* 字体卡片 */
        .font-card {
            background: #fff; border-radius: 12px; overflow: hidden; border: 1px solid rgba(0,0,0,0.03);
            transition: all 0.3s; display: flex; flex-direction: column; text-decoration: none; color: inherit;
            
            /* --- 桌面端优化 --- */
            /* 限制最大宽度，防止结果很少(如只有1个)时，卡片被 auto-fill 拉伸成巨型横幅。
               width: 100% 确保在正常列宽内填满。
            */
            max-width: 380px; 
            width: 100%;
        }
        .font-card:hover { transform: translateY(-5px); box-shadow: 0 18px 40px rgba(0,0,0,0.06); }
        .card-cover { height: 180px; background: #f0f0f0; overflow: hidden; }
        .card-cover img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .font-card:hover .card-cover img { transform: scale(1.05); }
        .card-info { padding: 18px; flex-grow: 1; display: flex; flex-direction: column; }
        .font-name { font-size: 18px; font-weight: 700; margin-bottom: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .font-author { font-size: 13px; color: #888; margin-bottom: 15px; }
        .card-footer { margin-top: auto; display: flex; justify-content: space-between; border-top: 1px solid #f5f5f5; padding-top: 12px; }
        .font-specs { font-size: 12px; color: #999; }
        .btn-view { font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 4px; }

        /* 分页 */
        .pagination-container { margin-top: 30px; display: flex; justify-content: center; gap: 8px; }
        .page-link { padding: 8px 14px; border: 1px solid #ddd; border-radius: 6px; color: #666; font-size: 14px; cursor: pointer; }
        .page-link.active { background: #1a1a1a; color: #fff; border-color: #1a1a1a; }

        /* 平板及移动端统一适配 (< 1024px) */
        @media (max-width: 1024px) {
            /* 布局改为垂直堆叠: 侧边栏在上，内容在下 */
            .doc-container { flex-direction: column; padding: 0 20px; margin-top: 20px; }
            
            /* 侧边栏样式重置 */
            .sidebar { width: 100%; position: static; max-height: none; border: none; padding: 0; }
            .category-header { background: #fff; border: 1px solid #eee; }
            .subcategory-list { background: #fff; border: 1px solid #eee; border-top: none; }
            
            /* Grid 逻辑调整 */
            .font-grid { gap: 20px; } 

            /* --- 移动端卡片优化 --- */
            /* 
               在移动端，取消 max-width 限制。
               - 如果屏幕很窄 (只能放1列)，Grid 分配给卡片 100% 宽度，卡片就全宽显示。
               - 如果屏幕稍宽 (能放2列)，Grid 分配给卡片 50% 宽度，卡片就自适应填满这 50%。
               这样既满足了“单行时满宽”，也满足了“能显示两行时正常显示”。
            */
            .font-card {
                max-width: 100% !important; 
            }
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <nav class="navbar" id="navbar"></nav>

        <div class="main-content">
            <div class="doc-container">
                <aside class="sidebar" id="sidebar">
                    <!-- 侧边栏搜索 -->
                    <div class="sidebar-search">
                        <input type="text" id="sidebarSearch" placeholder="搜索字体名称...">
                    </div>

                    <ul class="sidebar-menu">
                        <li class="category-item">
                            <div class="category-header open">字体分类<span>▼</span></div>
                            <ul class="subcategory-list" style="max-height: 500px;">
                                <li><a href="#all" class="subcategory-link" data-hash="all">全部字体 <span class="count-badge" id="count-all">0</span></a></li>
                                <li><a href="#sans_serif" class="subcategory-link" data-hash="sans_serif">黑体 / Sans <span class="count-badge" id="count-sans_serif">0</span></a></li>
                                <li><a href="#serif" class="subcategory-link" data-hash="serif">宋体 / Serif <span class="count-badge" id="count-serif">0</span></a></li>
                                <li><a href="#display" class="subcategory-link" data-hash="display">创意 / Display <span class="count-badge" id="count-display">0</span></a></li>
                            </ul>
                        </li>
                        <li class="category-item">
                            <div class="category-header open">风格筛选<span>▼</span></div>
                            <ul class="subcategory-list style-grid" style="max-height: 500px;">
                                <li><a href="#modern" class="subcategory-link" data-hash="modern">现代</a></li>
                                <li><a href="#retro" class="subcategory-link" data-hash="retro">复古</a></li>
                                <li><a href="#tech" class="subcategory-link" data-hash="tech">科技</a></li>
                            </ul>
                        </li>
                    </ul>
                </aside>

                <main class="content-area">
                    <div class="grid-header">
                        <div><h2 id="grid-title">全部字体</h2><p id="grid-desc">浏览我们精心挑选的字体库</p></div>
                    </div>
                    <div class="font-grid" id="font-grid-container"></div>
                    <div class="pagination-container" id="pagination-container"></div>
                </main>
            </div>
        </div>
        
        <footer class="footer" id="footer"></footer>
    </div> 
    
    <script src="common.js"></script> 
    
    <!-- 字体列表逻辑 -->
    <script>
        // 注意：url 请根据实际部署位置调整
        const FONT_DATA = [
            { id: 1, name: "自在起点黑VF", author: "免费商用双轴可变字体", category: "sans_serif", style: "modern", weight: "2025年8月7日", cover: "https://pic3.fukit.cn/autoupload/NWINCyTOTWqNUcPQazQq69iO_OyvX7mIgxFBfDMDErs/20251123/CX0k/4084X2500/1.png/webp", url: "fonts/qidiansans.html" },
        ];
        const FILTER_MAP = { 'all': '全部字体', 'sans_serif': '黑体', 'serif': '宋体', 'display': '创意', 'modern': '现代', 'retro': '复古', 'tech': '科技' };
        
        let currentFilter = 'all';
        let searchTerm = '';

        function renderGrid() {
            const container = document.getElementById('font-grid-container');
            const title = document.getElementById('grid-title');
            const desc = document.getElementById('grid-desc');

            let data = currentFilter === 'all' ? FONT_DATA : FONT_DATA.filter(i => i.category === currentFilter || i.style === currentFilter);
            
            if (searchTerm) {
                data = data.filter(i => i.name.toLowerCase().includes(searchTerm.toLowerCase()));
                title.innerText = `搜索: "${searchTerm}"`;
                desc.innerText = `找到 ${data.length} 个结果`;
            } else {
                title.innerText = FILTER_MAP[currentFilter] || "搜索结果";
                desc.innerText = `该分类下共有 ${data.length} 款字体`;
            }
            
            container.innerHTML = data.length ? data.map(f => `
                <a href="${f.url}" class="font-card" target="_blank">
                    <div class="card-cover"><img src="${f.cover}" loading="lazy"></div>
                    <div class="card-info">
                        <div class="font-name">${f.name}</div>
                        <div class="font-author">${f.author}</div>
                        <div class="card-footer"><div class="font-specs">${f.weight}</div><span class="btn-view">查看</span></div>
                    </div>
                </a>`).join('') : '<div style="padding:40px; text-align:center; width:100%; color:#999">暂无匹配字体</div>';

            document.querySelectorAll('.subcategory-link').forEach(l => {
                l.classList.toggle('active', l.getAttribute('data-hash') === currentFilter);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('count-all').innerText = FONT_DATA.length;
            ['sans_serif', 'serif', 'display'].forEach(c => {
                document.getElementById(`count-${c}`).innerText = FONT_DATA.filter(i => i.category === c).length;
            });

            const updateFromHash = () => {
                currentFilter = window.location.hash.slice(1) || 'all';
                renderGrid();
            };
            window.addEventListener('hashchange', updateFromHash);
            updateFromHash();

            const searchInput = document.getElementById('sidebarSearch');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchTerm = e.target.value.trim();
                    renderGrid();
                });
            }
            
            document.querySelectorAll('.category-header').forEach(h => h.addEventListener('click', (e) => {
                const list = e.currentTarget.nextElementSibling;
                e.currentTarget.classList.toggle('open');
                list.style.maxHeight = e.currentTarget.classList.contains('open') ? list.scrollHeight + 'px' : '0';
            }));
        });
    </script>
</body>
</html>